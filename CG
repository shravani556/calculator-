1) Machines should have secrets findings resolved

Remediate (Portal)

Go to Microsoft Defender for Cloud ‚Üí Recommendations.

Open ‚ÄúMachines should have secrets findings resolved‚Äù.

Review Affected resources and open a Finding to see the secret details.

Expand and follow the Remediation steps shown in the recommendation.

Rotate/revoke the exposed secret at its source (password/key/token), then remove it from the machine (delete plaintext files/env vars/configs).

Re-check until the resource is Healthy. 
Microsoft Learn
+1

Microsoft docs

Remediate secrets findings: 
Microsoft Learn

2) Windows servers should be configured to use secure communication protocols

This typically means disabling legacy SSL/TLS (like SSL 2.0/3.0, TLS 1.0/1.1) and ensuring modern TLS (TLS 1.2+) is enabled/used via Schannel settings on Windows. 
Microsoft Learn

Remediate (common approach in Azure environments)

Ensure the VM can be assessed/configured via Azure‚Äôs OS baseline tooling by installing the Azure Machine Configuration (guest configuration) extension and enabling a system-assigned managed identity on the VM. 
Microsoft Learn
+1

Configure Windows TLS/SSL (Schannel) protocol registry settings to disable legacy protocols and enable TLS 1.2 (and TLS 1.3 where applicable) using Microsoft‚Äôs supported registry guidance. 
Microsoft Learn

Reboot if required, then validate application compatibility (important for older clients/services).

Re-check compliance in the originating control (Defender for Cloud/Azure Policy/Azure Advisor) after the next evaluation cycle.

Microsoft docs

TLS registry settings (Schannel): 
Microsoft Learn

Machine Configuration extension (guest configuration): 
Microsoft Learn

Deploy guest configuration via Defender for Cloud: 
Microsoft Learn

3) Azure running container images should have vulnerabilities resolved

Remediate (Portal / Kubernetes runtime images)

In Defender for Cloud ‚Üí Recommendations, open the container image vulnerability recommendation.

Select the affected Kubernetes cluster, then a container to view vulnerabilities.

For each vulnerability, follow remediation guidance and:

Build a new image with patched package versions,

Push the updated image,

Replace workloads to use the new image (tag/digest),

Retire/remove the old vulnerable image where practical.

Re-check the recommendation until Healthy (results can take time to refresh). 
Microsoft Learn

Microsoft docs

View/remediate vulnerabilities for images running on Kubernetes clusters: 
Microsoft Learn

Agentless vulnerability assessment for containers (supported environments): 
Microsoft Learn

4) FTPS should be required in Function Apps

Remediate (Portal)

Open the Function App in the Azure portal.

Go to Settings ‚Üí Configuration ‚Üí General settings.

Under Platform settings, set FTP state = ‚ÄúFTPS only‚Äù (or Disabled if you don‚Äôt use FTP/FTPS deployment).

If using FTPS only, ensure Minimum Inbound TLS is TLS 1.2+ (TLS 1.0/1.1 aren‚Äôt supported for FTPS only).

Save. 
Microsoft Learn

Remediate (CLI)

az webapp config set ... --ftps-state FtpsOnly 
Microsoft Learn

Microsoft docs

Enforce FTPS (App Service / Functions): 
Microsoft Learn

Defender for Cloud App Service recommendations list (includes this item): 
Microsoft Learn

5) API endpoints in Azure API Management should be authenticated

Defender for Cloud flags APIs where no authentication mechanisms are enforced. It assesses authentication by checking for subscription keys (when subscription is required) and/or policies validating JWT, client certificates, or Microsoft Entra tokens. 
Microsoft Learn

Remediate (typical patterns)

Subscription key enforcement

Require subscriptions for your API/product and ensure callers use valid subscription keys. 
Microsoft Learn

Token-based authentication (Microsoft Entra / OAuth2 / OIDC)

Apply validate-jwt at the API or operation scope to require a valid bearer token. 
Microsoft Learn
+1

Mutual TLS / client certificate authentication

Configure APIM to require/validate client certificates (mTLS) and validate them using policy. 
Microsoft Learn
+1

Re-test calls and re-check Defender for Cloud until remediated.

Microsoft docs

Defender for Cloud API recommendations reference: 
Microsoft Learn

API Management auth overview: 
Microsoft Learn

APIM subscriptions (keys): 
Microsoft Learn

validate-jwt policy: 
Microsoft Learn

Client cert (mTLS) for clients: 
Microsoft Learn

validate-client-certificate policy: 
Microsoft Learn

6) Authentication should be enabled on API endpoints hosted in Function Apps

A strong baseline remediation is enabling App Service Authentication/Authorization (Easy Auth) for the Function App and setting unauthenticated behavior to require authentication. 
Microsoft Learn
+1

Remediate (Portal)

Open the Function App.

Go to Settings ‚Üí Authentication.

Enable authentication and Add identity provider (commonly Microsoft Entra).

Set Action to take when request is not authenticated to sign in / require authentication (block anonymous requests unless explicitly allowed). 
Microsoft Learn

Validate endpoint behavior (401/redirect as expected) and re-check the alert.

Microsoft docs

Easy Auth (App Service + Functions) and ‚Äúrequire authentication‚Äù behavior: 
Microsoft Learn
+1

Configure Microsoft Entra sign-in for Functions/App Service: 
Microsoft Learn

Securing Azure Functions (secure HTTP endpoints guidance): 
Microsoft Learn

7) SQL databases should have vulnerability findings resolved

Remediate

Ensure SQL vulnerability assessment is enabled (Express config is commonly used and can be enabled per DB/resource if needed). 
Microsoft Learn

From the DB‚Äôs Defender for Cloud page, open Vulnerability Assessment, view findings, and run an on-demand scan if required. 
Microsoft Learn

Open each failed finding to see impact and apply the recommended fix.

If a finding is acceptable for your environment, mark it as a baseline so it stops reporting as a failure. 
Microsoft Learn

Re-scan and confirm the recommendation becomes Healthy.

Microsoft docs

Enable VA (Express): 
Microsoft Learn

Run scans, remediate, and manage baselines: 
Microsoft Learn




Hi Baiji,

Hope you are doing well.

As part of the A00011 legacy cleanup activity, we are verifying whether any of the existing resources are still in use.

Could you please confirm:

1. If any A00011 legacy resources are currently being used by the application, and
2. If not, please share the list of resources (or environments) that we can safely proceed with deletion (at least test resources, as per the task).

Once we receive your confirmation and the approved list, we will proceed accordingly.

Thank you for your support.

Best regards,
Sravani B
git submodule deinit -f workload/modules/synapse && git rm -f workload/modules/synapse && rm -rf .git/modules/workload/modules/synapse
git submodule deinit -f workload/modules/synapse; git rm -f workload/modules/synapse; Remove-Item -Recurse -Force .git/modules/workload/modules/synapse
Here is a crisp and professional follow-up email you can send to Bryan:


---

Subject: Follow-up: Approval Needed ‚Äì Decommission/Region Migration for Sandbox Resources (MSAZ-11454)

Hi Bryan,

Just following up on my previous email regarding the remaining Sandbox resources in West Central US (Jira: MSAZ-11454).
We are awaiting your confirmation on whether to:

1. Decommission the listed resources, or


2. Proceed with region migration if decommissioning is not preferred.



Your approval will help us move this activity forward.
Please let me know if you need any additional details.

Copying Kash for visibility.

Thanks & Regards,
Sravani B


---

If you want a more firm / gentle reminder version, I can draft that too.vm2:
    resource_group_key: "application"
    os_type: windows
    enabled: true
    keyvault_key: "servicekv1"
    create_sshkeys: false

    network_interfaces:
      nic1:
        vm_setting_key: "windows"
        vnet_key: "vnet_1_key"
        subnet_key: "app_subnet"
        primary: true
        naming_convention:
          name_mask: "a0001-vm-02-r-01-d-nic"
        enable_ip_forwarding: false
        accelerated_networking_enabled: false
        private_ip_address_allocation: "Dynamic"

    virtual_machine_settings:
      windows:
        naming_convention:
          name_mask: "a0001vm02r01d"
        size: "Standard_D8s_v3"
        encryption_at_host_enabled: false
        zone: "1"
        network_interface_keys: ["nic1"]

        os_disk:
          naming_convention:
            name_mask: "{name}"
            name: "a0001-vm-02-r-01-d-osdisk"
          caching: "ReadWrite"
          storage_account_type: "StandardSSD_LRS"
          disk_size_gb: 128
          disk_encryption_set_key: "cmk_des"

        identity:
          type: "SystemAssigned, UserAssigned"
          managed_identity_keys: ["uaimv"]

        source_image_reference:
          publisher: "MicrosoftWindowsServer"
          offer: "WindowsServer"
          sku: "2019-Datacenter-gensecond"
          version: "latest"

Resources


| where type =~ "microsoft.compute/virtualmachines"
| project name, location, resourceGroup, subscriptionId, properties.hardwareProfile.vmSize, properties.osProfile.computerName
Azure Resources Backup & DR Analysis - Complete Details

Resource Type Default Backup Retention Period Backup Frequency PITR Capable Azure Backup Available Other Backup Methods Geo-Replication DR Capable MSFT Documentation
API Management ‚ùå No N/A N/A ‚ùå No ‚ùå No ARM Template Export Configuration Backup Manual Snapshots ‚úÖ Yes (Premium) ‚úÖ Yes https://docs.microsoft.com/en-us/azure/api-management/api-management-howto-disaster-recovery-backup-restore
Application Insights ‚ùå No 90 days N/A ‚ùå No ‚ùå No Data Export to Storage Log Analytics Export Continuous Export ‚ùå No ‚ùå No https://docs.microsoft.com/en-us/azure/azure-monitor/logs/logs-data-export
App Services ‚úÖ Yes Indefinite Automatic hourly ‚úÖ Yes ‚úÖ Yes Custom Backups to Storage ARM Templates Git Deployment ‚ùå No ‚úÖ Yes https://docs.microsoft.com/en-us/azure/app-service/manage-backup
Event Grid Topics ‚ùå No Transient N/A ‚ùå No ‚ùå No Dead Letter Storage ARM Template Export Multiple Subscriptions ‚úÖ Yes (Manual) ‚úÖ Yes https://docs.microsoft.com/en-us/azure/event-grid/geo-disaster-recovery
Event Hubs Namespace ‚ùå No 1-7 days N/A ‚ùå No ‚ùå No Capture to Storage Geo-Recovery Multiple Consumers ‚úÖ Yes (Manual) ‚úÖ Yes https://docs.microsoft.com/en-us/azure/event-hubs/event-hubs-geo-dr
Log Analytics Workspace ‚ùå No 30-90 days N/A ‚ùå No ‚ùå No Data Export to Storage Archive Tier Linked Storage Accounts ‚ùå No ‚ùå No https://docs.microsoft.com/en-us/azure/azure-monitor/logs/logs-data-export
Managed Applications ‚ùå No N/A N/A ‚ùå No ‚ùå No ARM Template Export Publisher Backup Tools Custom Scripts ‚ùå No ‚ùå No https://docs.microsoft.com/en-us/azure/azure-resource-manager/managed-applications/overview
Synapse Workspace ‚ö†Ô∏è Partial 7 days (SQL only) Automatic (SQL) ‚úÖ Yes (SQL only) ‚ùå No Git Integration SQL Pool Restore Points Storage Account Backup ‚ùå No ‚ùå No https://docs.microsoft.com/en-us/azure/synapse-analytics/backup-restore/backup-restore
Storage Accounts ‚ùå No Configurable N/A ‚úÖ Yes (with backup) ‚úÖ Yes (Blobs) Soft Delete Versioning Immutable Blobs AzCopy ‚úÖ Yes (Auto) ‚úÖ Yes https://docs.microsoft.com/en-us/azure/storage/common/storage-disaster-recovery-guidance

---

Additional Direct Links for Specific Features:

üõ†Ô∏è Implementation Guides:

¬∑ App Service Backup: https://docs.microsoft.com/en-us/azure/app-service/manage-backup
¬∑ Event Hubs Capture: https://docs.microsoft.com/en-us/azure/event-hubs/event-hubs-capture-enable-through-portal
¬∑ Storage Backup: https://docs.microsoft.com/en-us/azure/backup/blob-backup-configure-manage
¬∑ Log Analytics Export: https://docs.microsoft.com/en-us/azure/azure-monitor/logs/logs-data-export?tabs=portal
¬∑ Synapse Git Integration: https://docs.microsoft.com/en-us/azure/synapse-analytics/cicd/continuous-integration-deployment

üìö General Azure Backup:

¬∑ Azure Backup Overview: https://docs.microsoft.com/en-us/azure/backup/backup-overview
¬∑ Disaster Recovery: https://docs.microsoft.com/en-us/azure/architecture/framework/resiliency/backup-and-recovery

All links are direct Microsoft documentation starting with HTTPS for easy access and verification.
Azure SQL Database Snapshots - Official Microsoft Documentation

üìö Official Microsoft Documentation Links:

1. Database Snapshots (SQL Server Feature):

https://docs.microsoft.com/en-us/sql/relational-databases/databases/database-snapshots-sql-server

This covers traditional SQL Server database snapshots (on-premises & SQL Server on VMs)

2. Azure SQL Database - Manual Backups (Equivalent to Snapshots):

https://docs.microsoft.com/en-us/azure/azure-sql/database/automated-backups-overview#manual-backups

3. Database Copy (Similar to Snapshot Functionality):

https://docs.microsoft.com/en-us/azure/azure-sql/database/database-copy

---

üîç Azure SQL Database "Snapshot" Reality:

For Azure SQL Database:

¬∑ ‚ùå No traditional "snapshot" feature like VM snapshots
¬∑ ‚úÖ Equivalent functionality through:
  ¬∑ Database Copy (point-in-time copy)
  ¬∑ Manual exports (bacpac files)
  ¬∑ Point-in-Time Restore (PITR)

Available "Snapshot-like" Options:

Method Similar to Snapshot Retention Cost
Database Copy ‚úÖ Yes Until deleted Additional database cost
Export to bacpac ‚úÖ Yes Storage cost only Storage cost
PITR to new database ‚úÖ Yes Until deleted Additional database cost

---

üîÑ Snapshot vs Azure SQL Database Options:

Feature Traditional Snapshot Azure SQL Database Equivalent
Instant creation ‚úÖ Yes ‚ö†Ô∏è Fast (seconds to minutes)
Point-in-time ‚úÖ Yes ‚úÖ Yes (PITR)
Zero storage overhead ‚úÖ Yes (differential) ‚ùå No (full copy)
Automated ‚úÖ Yes ‚úÖ Yes (PITR)
Manual on-demand ‚úÖ Yes ‚úÖ Yes (Database Copy)

---

üéØ How to Create "Snapshots" in Azure SQL Database:

Method 1: Database Copy (Recommended)

```sql
-- Creates an exact copy at current point in time
CREATE DATABASE database_copy AS COPY OF original_database;
```

Method 2: Export to bacpac

¬∑ Use Azure Portal ‚Üí Export feature
¬∑ Creates downloadable bacpac file
¬∑ Stores in Azure Storage

Method 3: Point-in-Time Restore

¬∑ Restore to any point within retention period
¬∑ Creates new database from backup

---

üìä Snapshot Capability Summary:

Resource Type Snapshot Capable Snapshot Method Official Documentation
Azure SQL Database ‚ö†Ô∏è Partial Database Copy, Export https://docs.microsoft.com/en-us/azure/azure-sql/database/database-copy
Virtual Machines ‚úÖ Yes VM Snapshots https://docs.microsoft.com/en-us/azure/virtual-machines/snapshots
Storage Accounts ‚úÖ Yes Blob Snapshots https://docs.microsoft.com/en-us/azure/storage/blobs/snapshots-overview
App Services ‚ùå No Manual Backups https://docs.microsoft.com/en-us/azure/app-service/manage-backup

---

üö® Important Note:

"Azure SQL Database doesn't have traditional snapshots like VMs or storage. Instead, use Database Copy for immediate point-in-time copies or rely on the built-in PITR for recovery to any point within your retention period."

Your database a00003-arstaging-prd can use Database Copy for snapshot-like functionality, but it will incur additional costs for the copied database.


Here is a clean, professional email draft you can send to Bryan Caddy, copying Kash, exactly as your leads instructed.


---

Subject: Request for Confirmation ‚Äì Decommission or Region Migration for Sandbox Resources (West Central US)

Hi Bryan,

Hope you are doing well.

As part of the Jira task MSAZ-11454, I have reviewed the resources currently present in the Sandbox subscription under the West Central US region.
Below are the resources that are still active in this region:

Default Log Analytics Workspace

Network Watcher

Security Center‚Äìrelated solutions

SQL Advanced Threat Protection

SQL Vulnerability Assessment

Storage account (strguv01)

Other default security/monitoring components


All these resources are located in West Central US, and as per the analysis, there is no dependency to migrate them to another region, unless required by the subscription owner.

Before proceeding further, I would like to request your confirmation on one of the following actions:

1. Decommission these resources from the Sandbox environment
OR


2. Proceed with region migration to a standard region (if decommission is not approved)



Kindly confirm your preferred approach so we can proceed accordingly.
I have copied Kash for visibility.

Please let me know if you need any more details.

Thanks & Regards,
Sravani B


---

If you want, I can create another version that is shorter/more formal ‚Äî just tell me!
